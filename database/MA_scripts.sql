

--31y65x
--41y64x

select

	--(om_x * 100 + om_y) as "om_id",

	--om_y,
	--om_x,

	(omt_y * 1000 + omt_x) as "omt_id",

	omt_y,
	omt_x,

	((omt_y - 1) * 1000 + omt_x - 0) as "omt_id_N",
	((omt_y + 0) * 1000 + omt_x + 1) as "omt_id_E",
	((omt_y + 1) * 1000 + omt_x + 0) as "omt_id_S",
	((omt_y - 0) * 1000 + omt_x - 1) as "omt_id_W",

	((omt_y - 1) * 1000 + omt_x - 1) as "omt_id_NW",
	((omt_y + 1) * 1000 + omt_x + 1) as "omt_id_SE",
	((omt_y + 1) * 1000 + omt_x - 1) as "omt_id_SW",
	((omt_y - 1) * 1000 + omt_x + 1) as "omt_id_NE",

	--land_use_code,
	--primary_road_type,

	(case when land_use_code is null then 0 else land_use_code end) as "lu_code",
	(case when primary_road_type is null then 0 else 1 end) as "is_road",
	(case when land_use_code = 20 then 1 else 0 end) as "is_water"

from
	omt
where
	om_y = 41 and
	om_x = 64
order by
	om_y,
	om_x,
	omt_y,
	omt_x
;


select
	min(om_x) as "max_om_x",
	max(om_x) as "max_om_x",
	min(om_y) as "max_om_y",
	max(om_y) as "max_om_y",
	min(omt_x) as "max_omt_x",
	max(omt_x) as "max_omt_x",
	min(omt_y) as "max_omt_y",
	max(omt_y) as "max_omt_y",
	town_id,
	count(*)
from
	omt
group by
	town_id
order by
	count(*) desc
;

/*

max_om_x	max_om_x	max_om_y	max_om_y	max_omt_x	max_omt_x	max_omt_y	max_omt_y	town_id	count(*)
0	68	0	42	0	179	0	179		6841834
52	57	23	29	0	179	0	179	239	463812
48	52	24	28	0	179	0	179	182	324641
22	27	9	14	0	179	0	179	234	306858
58	62	30	34	0	179	0	179	20	286645
46	49	30	36	0	179	0	179	72	281035
21	24	9	15	0	179	0	179	204	263904
19	22	14	18	0	179	0	179	24	248536
9	12	16	20	0	179	0	179	33	240294
6	8	18	22	0	179	0	179	260	238316
45	47	31	37	0	179	0	179	334	238008
44	50	13	17	0	179	0	179	35	229391
61	68	39	42	0	179	0	179	197	224174
1	4	19	22	0	179	0	179	267	218514
44	48	23	27	0	179	0	179	293	217493
3	6	18	22	0	179	0	179	203	215595
6	9	14	17	0	179	0	179	22	214900
42	44	25	29	0	179	0	179	247	213467
12	15	18	21	0	179	0	179	329	212747
4	6	4	7	0	179	0	179	341	211197
54	57	32	36	0	179	0	179	96	208593
1	5	16	19	0	179	0	179	113	205809
21	23	19	22	0	179	0	179	191	201530
25	28	11	14	0	179	0	179	21	200676
56	59	28	32	0	179	0	179	261	198603
26	29	5	8	0	179	0	179	343	198582
27	30	18	21	0	179	0	179	54	196903
13	17	4	7	0	179	0	179	66	195195
10	12	19	22	0	179	0	179	112	194111
23	26	5	7	0	179	0	179	255	191616
3	6	10	13	0	179	0	179	236	190960
27	30	9	12	0	179	0	179	140	188791
54	57	28	32	0	179	0	179	36	187483
29	31	5	8	0	179	0	179	11	184320
23	26	12	16	0	179	0	179	124	183722
12	15	8	11	0	179	0	179	13	180971
22	25	14	17	0	179	0	179	309	179753
51	54	24	28	0	179	0	179	52	178617
26	28	19	22	0	179	0	179	287	175275
5	8	12	15	0	179	0	179	313	174530
44	47	29	33	0	179	0	179	95	174116
31	34	14	18	0	179	0	179	348	172856
6	9	16	19	0	179	0	179	225	171095
32	35	21	23	0	179	0	179	77	170662
14	16	8	12	0	179	0	179	68	170312
52	55	28	31	0	179	0	179	310	170087
21	23	4	7	0	179	0	179	312	169502
29	32	7	11	0	179	0	179	332	167513
9	12	14	17	0	179	0	179	59	167102
30	32	12	16	0	179	0	179	134	163313
28	31	12	15	0	179	0	179	257	163048
47	50	26	29	0	179	0	179	146	162420
49	52	28	31	0	179	0	179	250	162037
8	10	6	9	0	179	0	179	263	162001
22	24	6	9	0	179	0	179	223	161922
2	5	7	12	0	179	0	179	121	161316
29	32	10	13	0	179	0	179	241	161086
44	47	2	4	0	179	0	179	128	160870
14	17	13	16	0	179	0	179	214	160745
45	49	28	31	0	179	0	179	102	160025
19	21	4	8	0	179	0	179	217	159247
23	26	18	21	0	179	0	179	43	158802
7	10	9	11	0	179	0	179	345	158106
32	35	18	21	0	179	0	179	290	153009
28	30	15	18	0	179	0	179	280	152911
48	53	4	7	0	179	0	179	144	152546
35	38	6	9	0	179	0	179	115	151897
16	18	8	11	0	179	0	179	74	150414
23	26	7	10	0	179	0	179	15	150013
16	19	19	21	0	179	0	179	281	148733
33	35	5	7	0	179	0	179	299	148492
8	10	19	22	0	179	0	179	297	147676
26	28	7	10	0	179	0	179	294	145591
20	22	7	10	0	179	0	179	319	144890
43	46	5	8	0	179	0	179	9	144575
9	12	11	14	0	179	0	179	349	144349
21	24	17	19	0	179	0	179	227	143882
12	15	20	23	0	179	0	179	279	142783
32	34	11	13	0	179	0	179	282	142399
17	20	7	10	0	179	0	179	192	141385
38	40	6	10	0	179	0	179	330	141017
11	14	12	14	0	179	0	179	60	140498
10	13	7	9	0	179	0	179	129	137282
34	36	20	23	0	179	0	179	304	136237
31	34	8	11	0	179	0	179	153	133453
3	6	8	10	0	179	0	179	148	133024
43	46	23	26	0	179	0	179	218	131800
44	46	21	24	0	179	0	179	88	131449
52	54	19	22	0	179	0	179	171	130282
13	16	16	18	0	179	0	179	276	130155
47	49	23	25	0	179	0	179	42	127514
18	21	17	19	0	179	0	179	161	127408
31	33	7	9	0	179	0	179	97	126411
18	20	15	17	0	179	0	179	111	126225
34	36	9	13	0	179	0	179	147	125898
36	39	16	18	0	179	0	179	139	125244
40	44	24	26	0	179	0	179	16	124973
18	20	12	15	0	179	0	179	8	124787
33	35	7	10	0	179	0	179	162	124764
45	47	4	8	0	179	0	179	210	124626
23	26	17	19	0	179	0	179	311	124255
5	8	7	10	0	179	0	179	58	123742
55	58	38	40	0	179	0	179	89	123505
52	55	5	8	0	179	0	179	107	123450
30	32	18	21	0	179	0	179	226	123300
4	6	17	19	0	179	0	179	193	123230
13	14	14	16	0	179	0	179	331	123011
35	37	9	12	0	179	0	179	125	122097
19	21	10	13	0	179	0	179	272	121892
39	41	20	22	0	179	0	179	101	121519
4	6	13	16	0	179	0	179	150	121453
11	13	14	17	0	179	0	179	143	120476
10	15	6	7	0	179	0	179	53	119811
19	22	12	14	0	179	0	179	230	119398
38	40	14	17	0	179	0	179	100	119175
53	55	37	40	0	179	0	179	327	118514
41	44	7	10	0	179	0	179	31	118328
8	10	11	13	0	179	0	179	233	117074
56	58	31	35	0	179	0	179	172	116599
39	42	10	13	0	179	0	179	67	116170
14	16	11	14	0	179	0	179	340	115429
64	67	28	31	0	179	0	179	41	115098
62	64	30	33	0	179	0	179	351	113958
12	14	4	7	0	179	0	179	130	112152
48	51	2	4	0	179	0	179	205	111650
38	41	12	14	0	179	0	179	288	111277
25	27	7	11	0	179	0	179	235	110761
29	31	16	18	0	179	0	179	151	110760
16	18	12	16	0	179	0	179	117	110666
8	10	4	7	0	179	0	179	98	110645
52	55	21	23	0	179	0	179	82	109837
45	48	4	7	0	179	0	179	38	109784
43	45	19	22	0	179	0	179	266	109628
15	17	20	22	0	179	0	179	5	109614
8	10	13	15	0	179	0	179	183	108486
30	33	5	7	0	179	0	179	12	108439
10	12	4	6	0	179	0	179	253	108038
16	19	17	20	0	179	0	179	61	107325
2	4	14	16	0	179	0	179	283	106475
50	52	20	23	0	179	0	179	231	105911
17	19	4	6	0	179	0	179	29	105440
14	16	6	9	0	179	0	179	268	105258
34	35	17	19	0	179	0	179	110	104798
35	37	5	7	0	179	0	179	232	104455
41	45	28	31	0	179	0	179	292	104439
40	42	6	9	0	179	0	179	56	103794
10	12	10	12	0	179	0	179	69	103721
43	45	3	6	0	179	0	179	181	103717
28	30	7	9	0	179	0	179	103	103484
6	8	6	8	0	179	0	179	4	103240
18	20	10	12	0	179	0	179	154	103212
49	51	16	19	0	179	0	179	131	102876
15	17	16	19	0	179	0	179	137	102515
64	67	30	32	0	179	0	179	126	101837
39	42	21	23	0	179	0	179	350	101770
0	1	19	21	0	179	0	179	195	101093
19	21	18	21	0	179	0	179	339	100423
44	45	26	29	0	179	0	179	76	100087
64	67	21	24	0	179	0	179	300	100051
36	38	13	15	0	179	0	179	170	99380
26	28	15	17	0	179	0	179	212	98691
28	31	21	23	0	179	0	179	80	98623
16	18	6	8	0	179	0	179	114	98335
6	7	9	12	0	179	0	179	70	98324
35	37	17	20	0	179	0	179	303	98170
33	35	15	17	0	179	0	179	271	97834
6	8	10	13	0	179	0	179	132	97547
3	5	12	15	0	179	0	179	152	97415
46	48	20	22	0	179	0	179	44	96737
40	43	4	6	0	179	0	179	79	96705
35	37	15	17	0	179	0	179	328	96489
65	68	24	26	0	179	0	179	318	96394
10	12	9	11	0	179	0	179	237	96014
62	65	29	32	0	179	0	179	75	95673
50	52	18	20	0	179	0	179	219	95648
26	29	13	15	0	179	0	179	222	95406
42	44	6	9	0	179	0	179	295	95087
24	26	15	19	0	179	0	179	323	94910
42	44	18	21	0	179	0	179	307	94703
24	28	14	16	0	179	0	179	202	94041
26	29	20	22	0	179	0	179	278	93986
42	44	20	23	0	179	0	179	99	93721
46	48	23	26	0	179	0	179	245	93468
15	17	11	13	0	179	0	179	337	92918
6	8	5	6	0	179	0	179	209	92692
51	54	38	42	0	179	0	179	62	92360
48	50	30	34	0	179	0	179	201	91887
42	44	22	24	0	179	0	179	167	91843
38	40	9	12	0	179	0	179	2	91260
35	37	11	13	0	179	0	179	34	90281
12	15	7	9	0	179	0	179	47	89374
33	35	13	15	0	179	0	179	39	88801
19	21	20	22	0	179	0	179	120	88469
44	46	17	20	0	179	0	179	50	87862
40	42	23	25	0	179	0	179	211	87228
2	4	12	14	0	179	0	179	249	85793
51	53	23	25	0	179	0	179	145	85769
38	40	17	19	0	179	0	179	136	85661
38	39	20	23	0	179	0	179	25	85101
0	2	17	20	0	179	0	179	90	85080
49	50	29	32	0	179	0	179	3	84963
4	6	16	18	0	179	0	179	302	84786
48	51	4	6	0	179	0	179	254	84550
34	36	14	16	0	179	0	179	215	84277
41	42	26	29	0	179	0	179	265	84274
1	3	14	16	0	179	0	179	326	84160
16	18	15	18	0	179	0	179	275	82891
42	44	14	16	0	179	0	179	207	81622
38	40	5	7	0	179	0	179	301	81414
16	17	4	6	0	179	0	179	156	81338
34	36	19	21	0	179	0	179	216	81151
48	49	16	20	0	179	0	179	336	80966
37	39	11	13	0	179	0	179	286	80921
36	38	20	22	0	179	0	179	179	80829
11	13	17	20	0	179	0	179	256	80496
66	68	30	35	0	179	0	179	55	80308
51	54	17	20	0	179	0	179	264	79889
50	52	31	33	0	179	0	179	173	79678
12	14	11	13	0	179	0	179	108	79584
46	49	15	18	0	179	0	179	243	79362
48	50	21	23	0	179	0	179	83	78869
15	17	19	21	0	179	0	179	325	78859
37	39	8	10	0	179	0	179	158	78730
49	51	22	24	0	179	0	179	118	78179
41	43	13	15	0	179	0	179	333	77932
43	45	7	10	0	179	0	179	342	77083
16	17	12	14	0	179	0	179	127	75649
47	49	8	10	0	179	0	179	229	75600
37	39	5	7	0	179	0	179	81	75477
45	47	26	29	0	179	0	179	27	75098
42	44	11	13	0	179	0	179	155	74826
26	27	17	19	0	179	0	179	45	74550
45	46	19	21	0	179	0	179	285	74040
32	34	17	19	0	179	0	179	186	73942
30	32	17	19	0	179	0	179	17	73808
39	41	16	18	0	179	0	179	269	72638
49	51	0	2	0	179	0	179	259	72212
23	25	21	22	0	179	0	179	306	71987
40	42	15	17	0	179	0	179	198	71764
35	36	7	10	0	179	0	179	270	71478
40	41	13	15	0	179	0	179	315	71287
49	51	21	23	0	179	0	179	123	70748
46	48	22	24	0	179	0	179	322	70474
49	51	19	21	0	179	0	179	122	70267
49	51	8	9	0	179	0	179	30	69807
40	42	9	10	0	179	0	179	51	69803
36	38	15	16	0	179	0	179	277	69791
29	31	14	16	0	179	0	179	228	69482
41	43	16	18	0	179	0	179	78	69352
40	42	19	21	0	179	0	179	208	69231
50	52	23	25	0	179	0	179	240	67920
66	68	28	30	0	179	0	179	224	67864
12	13	17	19	0	179	0	179	194	67757
37	38	18	20	0	179	0	179	185	67568
41	42	11	13	0	179	0	179	157	67373
49	51	6	8	0	179	0	179	119	67051
18	20	6	8	0	179	0	179	106	66555
67	68	26	28	0	179	0	179	86	66411
17	19	10	12	0	179	0	179	289	66298
47	49	2	4	0	179	0	179	324	66225
51	53	6	8	0	179	0	179	92	66209
41	42	18	19	0	179	0	179	175	65893
30	32	21	23	0	179	0	179	316	65773
40	42	6	8	0	179	0	179	160	65331
46	48	7	9	0	179	0	179	184	65147
47	48	17	19	0	179	0	179	40	65011
51	53	29	32	0	179	0	179	169	64889
19	22	7	8	0	179	0	179	91	64690
49	54	35	38	0	179	0	179	109	63038
47	49	7	9	0	179	0	179	71	62424
32	33	13	15	0	179	0	179	321	62314
41	43	10	11	0	179	0	179	23	62198
47	49	0	2	0	179	0	179	7	62046
42	44	12	14	0	179	0	179	308	61874
14	17	16	17	0	179	0	179	87	61183
45	47	8	9	0	179	0	179	213	60645
4	6	7	8	0	179	0	179	200	60591
45	47	16	18	0	179	0	179	189	59971
35	36	12	14	0	179	0	179	28	59237
47	49	4	5	0	179	0	179	105	59112
25	26	21	22	0	179	0	179	135	58796
18	20	21	22	0	179	0	179	85	58622
44	45	10	12	0	179	0	179	347	58195
38	40	16	17	0	179	0	179	14	57889
6	9	4	5	0	179	0	179	63	57720
48	49	6	8	0	179	0	179	298	57545
49	51	31	34	0	179	0	179	94	57350
42	44	15	17	0	179	0	179	199	57186
40	41	18	20	0	179	0	179	187	55144
43	44	9	11	0	179	0	179	48	53338
36	38	13	14	0	179	0	179	141	53335
38	40	19	20	0	179	0	179	177	52462
47	49	10	12	0	179	0	179	163	52282
0	2	15	17	0	179	0	179	6	52111
40	42	22	24	0	179	0	179	238	51839
46	48	10	12	0	179	0	179	262	51650
37	38	22	23	0	179	0	179	32	51476
43	45	17	18	0	179	0	179	335	50267
9	11	4	5	0	179	0	179	190	48680
62	64	21	22	0	179	0	179	242	48342
43	45	16	18	0	179	0	179	73	48046
43	45	18	19	0	179	0	179	220	47438
41	43	15	16	0	179	0	179	317	47336
46	48	8	10	0	179	0	179	164	46958
27	28	17	19	0	179	0	179	84	46857
46	47	18	20	0	179	0	179	244	46825
37	38	10	11	0	179	0	179	37	46792
50	52	16	18	0	179	0	179	65	45924
47	49	19	21	0	179	0	179	1	45824
49	50	19	21	0	179	0	179	251	45506
45	46	9	10	0	179	0	179	246	44928
17	18	21	22	0	179	0	179	159	43313
36	38	8	9	0	179	0	179	19	42733
46	48	3	5	0	179	0	179	116	42257
46	48	1	2	0	179	0	179	180	40200
49	51	2	3	0	179	0	179	206	40008
48	52	9	11	0	179	0	179	258	38530
45	46	12	13	0	179	0	179	176	38224
44	45	29	31	0	179	0	179	273	37447
49	51	7	8	0	179	0	179	320	36626
46	47	10	11	0	179	0	179	305	35946
51	53	8	9	0	179	0	179	166	35613
55	56	37	38	0	179	0	179	221	33983
44	45	5	6	0	179	0	179	149	33402
47	48	19	20	0	179	0	179	133	33117
34	35	12	13	0	179	0	179	64	32647
54	56	5	7	0	179	0	179	252	32260
44	46	13	14	0	179	0	179	49	31943
48	49	21	22	0	179	0	179	338	31285
44	45	14	16	0	179	0	179	46	30697
54	56	36	38	0	179	0	179	296	30296
45	46	10	12	0	179	0	179	284	29881
47	48	12	13	0	179	0	179	248	28573
44	45	11	12	0	179	0	179	344	28543
51	52	40	41	0	179	0	179	104	26434
44	45	12	13	0	179	0	179	10	24678
38	39	12	13	0	179	0	179	174	24140
37	38	19	21	0	179	0	179	138	24017
46	47	12	13	0	179	0	179	165	22842
36	37	22	23	0	179	0	179	188	22143
46	47	11	12	0	179	0	179	178	21442
43	45	12	14	0	179	0	179	26	21212
46	47	19	21	0	179	0	179	18	20402
49	51	10	11	0	179	0	179	168	20284
45	46	12	14	0	179	0	179	274	18638
43	45	13	14	0	179	0	179	314	18546
46	47	12	13	0	179	0	179	93	15631
48	51	15	16	0	179	0	179	142	15005
49	50	11	11	0	179	5	144	291	14119
47	48	13	14	0	179	0	179	346	10837
46	47	13	13	0	179	1	138	57	10162
49	49	11	12	14	170	0	179	196	6133

*/